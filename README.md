
## Simple JWT Auth
This is a very basic implementation of a simple JWT (JSON Web Token) authentication. When used it stores a JWT in a cookie. The stored auth token is encrypted using sha256 in the `generate_credentials_hash()` method which uses the `jwt_secret` encoded with base64 as the key.

The `validate_function` closure can be changed to retrieve credentials using another method, like from a database, and must take three arguments: a login hash generated by `generate_credentials_hash()`, the current instance of the class, and the `jwt_secret`. It must then use `generate_credentials_hash()` to compare the passed login hash argument.

This class does not handle account creation or password management. only authorization.

---

### Example Usage

```php
require_once 'simple_auth.php';

$config = [
  'jwt_secret' => 'hunter2',
  'validate_function' => function($login_hash, $instance, $secret) {
    $login = [ 
      'username' => 'admin',
      'password' => 'pass'
    ];
    $valid_credentials = $instance->generate_credentials_hash($login['username'], $login['password'], $secret);
    return $login_hash === $valid_credentials;
  }
];

$auth = new Simple_Auth($config);

$auth->login('admin', 'pass');  // returns ['success']
$auth->login('wrong', 'login'); // returns ['error' => 'invalid']
$auth->login('user', '');       // returns ['error' => 'incomplete']

$auth->is_logged_in(); // returns true if valid token stored in cookie

$auth->logout('/login.php'); // forces cookie expiration and redirects to argument or '/' if left empty

```

---
### Notes


`login()` and `logout()` must be called before any headers are sent.


Run `php -S 0.0.0.0:80 -t ./example/` to view example login pages.